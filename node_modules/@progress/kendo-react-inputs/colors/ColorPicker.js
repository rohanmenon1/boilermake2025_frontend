/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2025 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const De=require("react"),o=require("prop-types"),n=require("@progress/kendo-react-common"),ze=require("../package-metadata.js"),Ne=require("./Picker.js"),Le=require("./ColorGradient.js"),W=require("./ColorPalette.js"),D=require("./FlatColorPicker.js"),xe=require("@progress/kendo-react-buttons"),qe=require("@progress/kendo-svg-icons"),d=require("../messages/index.js"),Ve=require("@progress/kendo-react-intl"),He=require("../common/AdaptiveMode.js"),Me=require("@progress/kendo-react-layout");function Ue(f){const S=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(f){for(const a in f)if(a!=="default"){const k=Object.getOwnPropertyDescriptor(f,a);Object.defineProperty(S,a,k.get?k:{enumerable:!0,get:()=>f[a]})}}return S.default=f,Object.freeze(S)}const t=Ue(De),je={opacity:!0},Ge={palette:W.DEFAULT_PRESET,tileSize:W.DEFAULT_TILE_SIZE},K=f=>f!==void 0,pe=n.createPropsContext(),$=t.forwardRef((f,S)=>{var le,ce;n.validatePackage(ze.packageMetadata);const a=n.usePropsContext(pe,f),k=Ve.useLocalization(),Z=n.useAdaptiveModeContext(),{size:p=w.size,rounded:z=w.rounded,fillMode:R=w.fillMode,gradientSettings:P=w.gradientSettings,paletteSettings:J=w.paletteSettings,flatColorPickerSettings:T,view:g=a.views?void 0:w.view,views:s=g?void 0:w.views,activeView:Q,popupSettings:C,valid:fe,disabled:N,tabIndex:ge,icon:L,svgIcon:x,iconClassName:A,onChange:q,onFocus:V,onBlur:H,onActiveColorClick:M,className:ve,adaptive:ke,adaptiveTitle:X=k.toLanguageString(d.colorPickerAdaptiveTitle,d.messages[d.colorPickerAdaptiveTitle])}=a,u=t.useRef(null),h=t.useRef(null),I=t.useRef(null),m=t.useRef(null),y=t.useRef(),me=t.useRef(null),[Ce,Y]=t.useState(!1),[be,Ee]=t.useState(a.defaultValue),[we,Pe]=t.useState(!1),[F,ye]=t.useState(),U=K(a.value),b=K(a.open),c=U?a.value:be,E=b?a.open:we,ee=t.useRef(c),te=t.useCallback(()=>{u.current&&u.current.focus()},[]);t.useImperativeHandle(S,()=>({element:u.current,actionElement:me.current,value:c,focus:te}),[c,te]);const Se=!!(F&&Z&&F<=Z.medium&&ke);t.useEffect(()=>{const e=n.canUseDOM&&window.ResizeObserver&&new window.ResizeObserver(Be.bind(void 0));return document!=null&&document.body&&e&&e.observe(document.body),()=>{document!=null&&document.body&&e&&e.disconnect()}},[]);const l=t.useCallback((e,i)=>{b||(!e&&!i&&u&&u.current&&u.current.focus(),Pe(e))},[b]),ne=t.useMemo(()=>new n.Navigation({root:u,selectors:[".k-colorpicker",".k-color-picker-popup"],tabIndex:0,keyboardEvents:{keydown:{Escape:(e,i,r)=>{l(!1)},Enter:(e,i,r)=>{!b&&e===u.current&&(r.preventDefault(),r.stopPropagation(),l(!0))},ArrowDown:(e,i,r)=>{r.altKey&&(r.preventDefault(),r.stopPropagation(),l(!0))},ArrowUp:(e,i,r)=>{r.altKey&&(r.preventDefault(),r.stopPropagation(),l(!1))},Tab:(e,i,r)=>{var _,ie,se;if(n.getActiveElement(document)!==u.current){const ue=(_=I.current)==null?void 0:_.wrapperRef.current,O=(ie=h.current)==null?void 0:ie.wrapperRef.current,de=(se=m.current)==null?void 0:se.element;g==="palette"&&ue?n.keepFocusInContainer(r,ue):g==="gradient"&&O?n.keepFocusInContainer(r,O):g==="combo"&&O?n.keepFocusInContainer(r,O.parentElement):s&&de&&n.keepFocusInContainer(r,de)}}}}}),[l,b]),Te=t.useCallback(ne.triggerKeyboardEvent.bind(ne),[]),he=t.useCallback(()=>{b||(h.current&&h.current.wrapperRef.current?n.focusFirstFocusableChild(h.current.wrapperRef.current):I.current?I.current.focus():m.current&&m.current.element&&n.focusFirstFocusableChild(m.current.element))},[b]),B=e=>ee.current=e,ae=t.useCallback(e=>{const i={value:ee.current,nativeEvent:e.nativeEvent,syntheticEvent:e};v(i),l(!E,!0)},[E]),j=t.useCallback(()=>{l(!1,!0)},[l]),_e=t.useCallback(e=>{M&&M.call(void 0,{syntheticEvent:e,nativeEvent:e.nativeEvent,value:c,target:{element:u.current,value:c}})},[M,c]),Re=t.useCallback(e=>{y.current?(clearTimeout(y.current),y.current=void 0):Y(!0),V&&V.call(void 0,{nativeEvent:e.nativeEvent,syntheticEvent:e})},[V]),Ae=t.useCallback(()=>{l(!1,!0),Y(!1),y.current=void 0},[]),Ie=t.useCallback(e=>{clearTimeout(y.current),y.current=window.setTimeout(Ae),H&&H.call(void 0,{nativeEvent:e.nativeEvent,syntheticEvent:e})},[H]),v=t.useCallback((e,i)=>{var _;const r=i?e.rgbaValue||"":(_=e.value)!=null?_:"";U||Ee(r),q&&q.call(void 0,{value:r,nativeEvent:e.nativeEvent,syntheticEvent:e.syntheticEvent,target:{element:u.current,value:r}}),l(!1)},[U,q]),re=t.useCallback(e=>v(e,!0),[K,v]),G=t.useCallback(e=>t.createElement(t.Fragment,null,(g==="combo"||g==="gradient")&&t.createElement(Le.ColorGradient,{...P,_adaptive:e,ref:h,isInsidePopup:!0,size:e?"large":p,fillMode:R,value:c,onChange:v}),(g==="combo"||g==="palette")&&t.createElement(W.ColorPalette,{...J,ref:I,size:e?"large":p,value:c,onChange:re}),s&&s[0]==="gradient"&&s[1]==="palette"&&t.createElement(D.FlatColorPicker,{...T,_gradientSettings:{_adaptive:e,...P},ref:m,size:e?"large":p,views:["gradient","palette"],activeView:Q,setOpen:l,showButtons:!e,value:c,onChange:v,setAdaptiveModeValue:B}),s&&s[0]==="palette"&&s[1]==="gradient"&&t.createElement(D.FlatColorPicker,{...T,_gradientSettings:{_adaptive:e,...P},ref:m,size:e?"large":p,views:["palette","gradient"],setOpen:l,showButtons:!e,value:c,onChange:v,setAdaptiveModeValue:B}),s&&s.includes("gradient")&&!s.includes("palette")&&t.createElement(D.FlatColorPicker,{...T,_gradientSettings:{_adaptive:e,...P},ref:m,size:e?"large":p,views:["gradient"],showButtons:!e,setOpen:l,value:c,onChange:v,setAdaptiveModeValue:B}),s&&s.includes("palette")&&!s.includes("gradient")&&t.createElement(D.FlatColorPicker,{...T,_gradientSettings:{_adaptive:e,...P},ref:m,size:e?"large":p,views:["palette"],showButtons:!e,setOpen:l,value:c,onChange:v,setAdaptiveModeValue:B})),[Q,R,T,P,v,re,J,l,p,c,g,s]),Fe=t.useCallback(()=>{var i;const e={animation:!!((i=C==null?void 0:C.animate)==null||i),title:X,expand:E,onClose:j,windowWidth:F,footer:{cancelText:k.toLanguageString(d.flatColorPickerCancelBtn,d.messages[d.flatColorPickerCancelBtn]),onCancel:j,applyText:k.toLanguageString(d.flatColorPickerApplyBtn,d.messages[d.flatColorPickerApplyBtn]),onApply:ae}};return t.createElement(He.AdaptiveMode,{...e},t.createElement(Me.ActionSheetContent,{overflowHidden:!0},G(!0)))},[C==null?void 0:C.animate,X,E,j,F,k,ae,G]),Be=t.useCallback(e=>{for(const i of e)ye(i.target.clientWidth)},[]),oe=n.useDir(u,a.dir),Oe=fe!==!1;return t.createElement("span",{id:a.id,role:"combobox","aria-label":a.ariaLabel,"aria-labelledby":a.ariaLabelledBy,"aria-describedby":a.ariaDescribedBy,"aria-haspopup":"dialog","aria-expanded":E,"aria-controls":`k-colorpicker-popup-${(le=a.id)!=null?le:0}`,"aria-disabled":N?"true":void 0,className:n.classNames("k-colorpicker","k-picker","k-icon-picker",{[`k-picker-${n.kendoThemeMaps.sizeMap[p]||p}`]:p,[`k-picker-${R}`]:R,[`k-rounded-${n.kendoThemeMaps.roundedMap[z]||z}`]:z,"k-invalid":!Oe,"k-disabled":N,"k-focus":Ce,className:ve}),ref:u,tabIndex:n.getTabIndex(ge,N),title:a.title,onKeyDown:Te,onFocus:Re,onBlur:Ie,dir:oe},t.createElement(Ne.Picker,{dir:oe,open:E,onOpen:he,popupAnchor:u.current||void 0,popupSettings:{id:`k-colorpicker-popup-${(ce=a.id)!=null?ce:0}`,...C},input:t.createElement("span",{onClick:_e,className:"k-input-inner"},t.createElement("span",{className:n.classNames("k-value-icon","k-color-preview",{"k-no-color":!c,"k-icon-color-preview":L||x||A})},A&&t.createElement("span",{className:n.classNames("k-color-preview-icon",A)}),!A&&(L||x)&&t.createElement(n.IconWrap,{name:L,icon:x}),t.createElement("span",{className:"k-color-preview-mask",style:{backgroundColor:c}}))),button:t.createElement(xe.Button,{tabIndex:-1,type:"button",onClick:()=>l(!E),className:"k-input-button",rounded:null,icon:"caret-alt-down",svgIcon:qe.caretAltDownIcon,"aria-label":k.toLanguageString(d.colorPickerDropdownButtonAriaLabel,d.messages[d.colorPickerDropdownButtonAriaLabel])}),content:G(!1),_mobileMode:Se,_actionSheet:Fe()}))});$.propTypes={value:o.string,defaultValue:o.string,disabled:o.bool,view:o.oneOf(["gradient","palette","combo"]),views:o.arrayOf(o.oneOf(["gradient","palette"])),dir:o.string,id:o.string,icon:o.string,svgIcon:n.svgIconPropType,ariaLabelledBy:o.string,ariaDescribedBy:o.string,size:o.oneOf([null,"small","medium","large"]),rounded:o.oneOf([null,"small","medium","large","full"]),fillMode:o.oneOf([null,"solid","flat","outline"]),className:o.string,adaptive:o.bool,adaptiveTitle:o.string};const w={size:"medium",rounded:"medium",fillMode:"solid",view:"palette",views:["gradient","palette"],gradientSettings:je,paletteSettings:Ge};$.displayName="KendoColorPicker";exports.ColorPicker=$;exports.ColorPickerPropsContext=pe;
